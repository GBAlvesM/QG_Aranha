<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="styles/filmes.css">
    <link rel="shortcut icon" href="assets/favicon.png" type="image/x-icon">
    <title>Filmes</title>
</head>

<body onload="muralComents(); carregarComentarios()">
    <div class="navbar">
        <img src="assets/logo.png" alt="" class="logo">
        <div class="menucentral">
            <a href="index.html">Início</a>
            <a href="historia.html">História</a>
            <a href="filmes.html" style="color: #ff0000;">Filmes</a>
            <a href="#" onclick="logado()" id="linkquiz">Quiz</a>
            <a href="sobre.html">Sobre Mim</a>
        </div>
        <div class="user">
            <a href="login.html" id="logar">Login</a>
            <a href="cadastro.html" id="cadastro">Cadastro</a>
            <a href="index.html" onclick="logout()" id="sairAgora" style="display: none;">Sair</a>
        </div>
    </div>
    <div class="conteudo">
        <div class="selecao">
            <h1>Selecione um Aranha para ver a lista de seus filmes</h1>
            <div class="aranhas">
                <div class="cardaranha" id="tobey" onclick="mostrarTobey()"></div>
                <div class="cardaranha" id="andrew" onclick="mostrarAndrew()"></div>
                <div class="cardaranha" id="tom" onclick="mostrarTom()"></div>
                <div class="cardaranha" id="miles" onclick="mostrarMiles()"></div>
            </div>
            <div id="filmes">
                <div id="filmestobey" style="display: none;">
                    <div class="ftxt">
                        <div id="f1" class="cardfilme"></div>
                        <div class="boxfilme">
                            <h2>Homem-Aranha 1 (2002)</h2>
                            <p>Peter Parker é mordido por uma aranha geneticamente modificada e assume o manto do herói.
                                Ele precisa proteger Mary Jane ao enfrentar seu primeiro grande inimigo: o Duende Verde.
                            </p>
                        </div>
                    </div>
                    <div class="ftxt">
                        <div id="f2" class="cardfilme"></div>
                        <div class="boxfilme">
                            <h2>Homem-Aranha 2 (2004)</h2>
                            <p>Peter luta para equilibrar sua vida pessoal, acadêmica e heroica. Ele precisa deter Dr.
                                Octopus, um cientista brilhante que se torna um vilão descontrolado após um experimento
                                falhar.</p>
                        </div>
                    </div>
                    <div class="ftxt">
                        <div id="f3" class="cardfilme"></div>
                        <div class="boxfilme">
                            <h2>Homem-Aranha 3 (2007)</h2>
                            <p>Peter enfrenta múltiplas ameaças (Homem-Areia, Venom e Duende Verde Jr.) enquanto lida
                                com a influência sombria e corruptora do simbionte alienígena em sua personalidade.</p>
                        </div>
                    </div>
                </div>
                <div id="filmesandrew" style="display: none;">
                    <div class="ftxt">
                        <div id="f1a" class="cardfilme"></div>
                        <div class="boxfilme">
                            <h2>O Espetacular Homem-Aranha (2012)</h2>
                            <p>Peter investiga o misterioso passado de seus pais e desenvolve seus poderes. Ele se
                                apaixona por Gwen Stacy e confronta o Lagarto, uma versão criatura do Dr. Curt Connors.
                            </p>
                        </div>
                    </div>
                    <div class="ftxt">
                        <div id="f2a" class="cardfilme"></div>
                        <div class="boxfilme">
                            <h2>O Espetacular Homem-Aranha 2 (2014)</h2>
                            <p>Peter lida com a promessa que fez ao pai de Gwen sobre mantê-la segura. Ele enfrenta
                                Electro e descobre segredos chocantes sobre a obscura corporação Oscorp.</p>
                        </div>
                    </div>
                </div>
                <div id="filmestom" style="display: none;">
                    <div class="ftxt">
                        <div id="f1t" class="cardfilme"></div>
                        <div class="boxfilme">
                            <h2>Homem-Aranha: De Volta ao Lar (2017)</h2>
                            <p>Peter tenta provar seu valor como Vingador, lidando com os desafios do ensino médio. Ele
                                enfrenta o Abutre, que usa tecnologia alienígena em seus crimes.</p>
                        </div>
                    </div>
                    <div class="ftxt">
                        <div id="f2t" class="cardfilme"></div>
                        <div class="boxfilme">
                            <h2>Homem-Aranha: Longe de Casa (2019)</h2>
                            <p>Durante uma viagem escolar pela Europa, Peter é recrutado por Nick Fury para lutar contra
                                os Elementais, ao lado do misterioso herói interdimensional Mysterio.</p>
                        </div>
                    </div>
                    <div class="ftxt">
                        <div id="f3t" class="cardfilme"></div>
                        <div class="boxfilme">
                            <h2>Homem-Aranha: Sem Volta Para Casa (2021)</h2>
                            <p>Após ter sua identidade revelada, Peter pede um feitiço ao Dr. Estranho. O feitiço falha,
                                trazendo vilões multiversais de outras realidades para o MCU.</p>
                        </div>
                    </div>
                </div>
                <div id="filmesmiles" style="display: none;">
                    <div class="ftxt">
                        <div id="f1m" class="cardfilme"></div>
                        <div class="boxfilme">
                            <h2>Homem-Aranha no Aranhaverso (2018)</h2>
                            <p>Miles Morales, mordido por uma aranha, conhece outras versões do Homem-Aranha de
                                diferentes dimensões. Eles devem se unir para deter o vilão Rei do Crime.</p>
                        </div>
                    </div>
                    <div class="ftxt">
                        <div id="f2m" class="cardfilme"></div>
                        <div class="boxfilme">
                            <h2>Homem-Aranha: Através do Aranhaverso (2023)</h2>
                            <p>Miles viaja pelo multiverso e se reúne com Gwen Stacy, mas entra em conflito com a
                                Sociedade Aranha ao questionar a necessidade dos "eventos canônico".</p>
                        </div>
                    </div>
                </div>
            </div>
            <div id="mural" style="display: none;">
                <h1>Mural de Comentários</h1>
                <h2>Insira um comentário sobre algum filme</h2>
                <div class="comentario"><textarea name="comentario" id="ipt_comentario" maxlength="250"
                        rows="5"></textarea> <button onclick="comentarioNovo()">Enviar</button></div>
            </div>
            <div id="postados" style="display: none;">

            </div>
        </div>
    </div>
    <footer class="rodape">
        <div class="conteudorodape">
            <h3>QG Aranha</h3>
            <p>Unindo todos os fãs do <br>Cabeça de Teia no Multiverso.</p>
            <img src="assets/favicon.png" alt="" style="width: 70px; margin-top: 15px;">
            <span>Feito por Gabriel Alves Miguel</span>
        </div>
        <div class="conteudorodape">
            <h3>Navegar</h3>
            <a href="index.html">Início</a>
            <a href="historia.html">História</a>
            <a href="filmes.html">Filmes</a>
            <a href="quiz.html" onclick="logado3()" id="linkquiz3">Quiz</a>
            <a href="sobre.html">Sobre Mim</a>
        </div>
        <div class="conteudorodape">
            <h3>Contato</h3>
            <a href="">gabriel.miguel@sptech.school</a>
        </div>
        <div class="conteudorodape">
            <h3>Redes Sociais</h3>
            <p><a href="https://www.linkedin.com/in/gabriel-alves-miguel/?skipRedirect=true" target="_blank"><img
                        src="assets/linkedin.png" alt="" style="height: 30px;"></a> <a
                    href="https://github.com/GBAlvesM/" target="_blank"><img src="assets/github.png" alt=""
                        style="height: 30px;"></a></p>
        </div>
    </footer>
</body>
<script>
    function mostrarTobey() {
        tobey.style.opacity = '1'
        tobey.style.transform = 'scale(1.09)'

        tom.style.opacity = '0.3'
        tom.style.transform = ''
        andrew.style.opacity = '0.3'
        andrew.style.transform = ''
        miles.style.opacity = '0.3'
        miles.style.transform = ''

        filmestobey.style.display = "flex"
        filmesandrew.style.display = "none"
        filmestom.style.display = "none"
        filmesmiles.style.display = "none"
    }

    function mostrarAndrew() {
        andrew.style.opacity = '1'
        andrew.style.transform = 'scale(1.09)'

        tom.style.opacity = '0.3'
        tom.style.transform = ''
        tobey.style.opacity = '0.3'
        tobey.style.transform = ''
        miles.style.opacity = '0.3'
        miles.style.transform = ''

        filmesandrew.style.display = "flex"
        filmestobey.style.display = "none"
        filmestom.style.display = "none"
        filmesmiles.style.display = "none"
    }

    function mostrarTom() {
        tom.style.opacity = '1'
        tom.style.transform = 'scale(1.09)'

        tobey.style.opacity = '0.3'
        tobey.style.transform = ''
        andrew.style.opacity = '0.3'
        andrew.style.transform = ''
        miles.style.opacity = '0.3'
        miles.style.transform = ''

        filmestom.style.display = "flex"
        filmestobey.style.display = "none"
        filmesandrew.style.display = "none"
        filmesmiles.style.display = "none"
    }

    function mostrarMiles() {
        miles.style.opacity = '1'
        miles.style.transform = 'scale(1.09)'

        tom.style.opacity = '0.3'
        tom.style.transform = ''
        tobey.style.opacity = '0.3'
        tobey.style.transform = ''
        andrew.style.opacity = '0.3'
        andrew.style.transform = ''

        filmesmiles.style.display = "flex"
        filmestobey.style.display = "none"
        filmesandrew.style.display = "none"
        filmestom.style.display = "none"
    }

    function logado() {
        var link = document.getElementById("linkquiz")

        if (sessionStorage.ID_USUARIO) {
            link.href = "quiz.html"
        } else {
            link.href = "login.html"
        }
    }

    function logado3() {
        var link = document.getElementById("linkquiz3")

        if (sessionStorage.ID_USUARIO) {
            link.href = "quiz.html"
        } else {
            link.href = "login.html"
        }
    }

    function muralComents() {

        if (sessionStorage.ID_USUARIO) {
            mural.style.display = "block"
            postados.style.display = "block"
        }
    }



    function comentarioNovo() {
        let txtComentario = ipt_comentario.value
        let idUsuario = sessionStorage.ID_USUARIO

        ipt_comentario.value = ""
        postados.innerHTML = ""

        fetch("/usuarios/comentar", {
            method: "POST",
            headers: {
                "Content-Type": "application/json",
            },
            body: JSON.stringify({
                // crie um atributo que recebe o valor recuperado aqui
                // Agora vá para o arquivo routes/usuario.js
                comentarioServer: txtComentario,
                idServer: idUsuario
            }),
        })
            .then(function (resposta) {
                console.log("resposta: ", resposta);

                if (resposta.ok) {

                    carregarComentarios();

                } else {
                    alert('Houve um erro ao tentar cadastrar o comentário!')
                    throw "Houve um erro ao tentar cadastrar o comentário!";
                }
            })
            .catch(function (resposta) {
                console.log(`#ERRO: ${resposta}`);
            });

        return false;
    }

    function carregarComentarios() {
        fetch("/usuarios/carregarComentarios", {
            method: "GET",
            headers: {
                "Content-Type": "application/json",
            },
        })
            .then(function (responseC) {
                if (responseC.ok) {
                    responseC.json().then(function (comentariosMural) {
                        console.log(`Dados recebidos: ${JSON.stringify(comentariosMural)}`)

                        var autores = []
                        var comentarios = []

                        comentariosMural.forEach(item => {
                            autores.push(item.nome)
                            comentarios.push(item.comentario)
                        })

                        var resultadoComentarios = ''

                        for (let i = 0; i < autores.length; i++) {
                            resultadoComentarios += `<div class="comentarioM">
                                <h3>${autores[i]}</h3>
                                <p>"${comentarios[i]}"</p>
                            </div> `
                        }

                        postados.innerHTML = resultadoComentarios

                    }
                    )
                } else {
                    console.error('Nenhum dado encontrado ou erro na API')
                }
            })
            .catch(function (error) {
                console.error(`Erro na obtenção dos dados para o gráfico ${error.message}`)
            })
    }

    if (sessionStorage.ID_USUARIO) {
        logar.style.display = "none"
        cadastro.style.display = "none"
        sairAgora.style.display = "block"
    }

    function logout() {
        sessionStorage.clear()
    }

</script>

</html>